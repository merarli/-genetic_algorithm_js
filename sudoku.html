<!DOCTYPE html>
<html lang="jp" dir="ltr">
<head>
  <meta charset="utf-8">
  <title></title>
</head>
<body>

  <script>
  //個体数
  individual = 3;
  //遺伝子情報を格納する
  gen = [];

  tmp_shortage = [];

  question = [
    [5, 3, 0, 0, 7, 0, 0, 0, 0],
    [6, 0, 0, 1, 9, 5, 0, 0, 0],
    [0, 9, 8, 0, 0, 0, 0, 6, 0],
    [8, 0, 0, 0, 6, 0, 0, 0, 3],
    [4, 0, 0, 8, 0, 3, 0, 0, 1],
    [7, 0, 0, 0, 2, 0, 0, 0, 6],
    [0, 6, 0, 0, 0, 0, 2, 8, 0],
    [0, 0, 0, 4, 1, 9, 0, 0, 5],
    [0, 0, 0, 0, 8, 0, 0, 7, 9],
  ];



  // console.log(question);
  //各行の足りない数字リストを表示する
  shortage = shortage();
  generate();

  function shortage(){
    //各行の足りない数字リスト
    var shortage = [];
    var tmp = [];
    for (var i = 0; i < question.length; i++) {
      // console.log(question[i]);
      for (var y = 1; y < 10; y++) {
        // console.log('1-9: ' + y);
        if (question[i].indexOf(y) == -1){
          // 存在しない
          // console.log(i + '番目には' + y + 'が存在しない');
          tmp.push(y);
        }
      }
      shortage.push(tmp);
      tmp = [];
    }
    console.log(shortage);
    return shortage;
  }

  //遺伝子を作成
  function generate(){
    var tmp = ''
    for (var i = 0; i < individual; i++) {
      gen[i] = [];
      for (var j = 0; j < question.length; j++) {
        gen[i][j] = [];
        for (var g = 0; g < question[j].length; g++) {

          gen[i][j][g] = question[j][g];
          // console.log(question[j][g]);
          tmp += question[j][g] + ',';

        }
        console.log(tmp);
        tmp = '';
      }
    }



    console.log('初期コピー');
    // gen[0][0][0] = 0;
    showGen();

    //ベース遺伝子情報をすべてfor
    for (var geni = 0; geni < gen.length; geni++) {
      //足りないものリストの初期化

      for (var genj = 0; genj < gen[geni].length; genj++) {
        // var tmp_shortage = initShortage();
        //足りないものリストの初期化
        var tmp_shortage = JSON.parse(JSON.stringify(shortage));
        for (var geng = 0; geng < gen[geni][genj].length; geng++) {
          // console.log('geng: ' + geng);


          //遺伝子情報が0なら
          // console.log('gen[geni][genj][geng]: ' + gen[geni][genj][geng]);
          // console.log(geni + ',' + genj + ',' + geng + ': ' + gen[geni][genj][geng]);
          if(gen[geni][genj][geng] == 0){
            // console.log('0発見！');
            //足りないものリストからランダムで数字を選ぶ
            var random = tmp_shortage[genj][Math.floor(Math.random() * tmp_shortage[genj].length)];
            // console.log(geni + ',' + genj + ',' + geng + ': ' + random);
            //選ばれた数字で代入
            gen[geni][genj][geng] = random;

            console.log(0 + ',' + genj + ',' + geng + ': ' + gen[0][genj][geng]);
            console.log(1 + ',' + genj + ',' + geng + ': ' + gen[1][genj][geng]);
            console.log(2 + ',' + genj + ',' + geng + ': ' + gen[2][genj][geng]);

            //一度ランダムで選ばれた値を配列から消す
            var idx = tmp_shortage[genj].indexOf(random);
            if(idx >= 0){
              tmp_shortage[genj].splice(idx, 1);
            }

          }

        }
      }
    }
    console.log('書き換え遺伝子い表示');
    showGen();





    // var tmp_shortage = shortage;
    // for (var j = 0; j < tmp_shortage.length; j++) {
    //
    //   var loop = tmp_shortage[j].length;
    //   for (var i = 0; i < loop; i++) {
    //
    //     console.log('消されたかチェック:' + tmp_shortage[j]);
    //     //配列の中からランダムで１つ選ぶ
    //     var random = tmp_shortage[j][Math.floor(Math.random() * tmp_shortage[j].length)];
    //     // gen[][][] = random; 謎が深い
    //
    //     //一度ランダムで選ばれた値を配列から消す
    //     var idx = tmp_shortage[j].indexOf(random);
    //     if(idx >= 0){
    //       tmp_shortage[j].splice(idx, 1);
    //     }
    //
    //   }
    // }
  }

  function showGen(){
    var strTmp = '';
    for (var i = 0; i < gen.length; i++) {
      console.log(i + '個目');
      for (var j = 0; j < gen[i].length; j++) {
        for (var g = 0; g < gen[i][j].length; g++) {

          //列の状態表示
          strTmp += gen[i][j][g];
          if(gen[i][j][g] == 0){
            // console.log('gen[' + i +'][' + j + '][' + g + ']は0');
          }

        }
        console.log('strTmp: ' + strTmp);
        strTmp = '';
      }
    }
  }


  </script>
</body>
</html>
